<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/erizo-dev-blog/styles.37d707e0bdb80da7c061.css">code[class*=language-],pre[class*=language-]{color:#ccc;background:none;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto}:not(pre)>code[class*=language-],pre[class*=language-]{background:#2d2d2d}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.block-comment,.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#999}.token.punctuation{color:#ccc}.token.attr-name,.token.deleted,.token.namespace,.token.tag{color:#e2777a}.token.function-name{color:#6196cc}.token.boolean,.token.function,.token.number{color:#f08d49}.token.class-name,.token.constant,.token.property,.token.symbol{color:#f8c555}.token.atrule,.token.builtin,.token.important,.token.keyword,.token.selector{color:#cc99cd}.token.attr-value,.token.char,.token.regex,.token.string,.token.variable{color:#7ec699}.token.entity,.token.operator,.token.url{color:#67cdcc}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.token.inserted{color:green}body,html{font-family:Montserrat,sans-serif;margin:0;padding:0}a{-webkit-text-decoration:"none";text-decoration:"none";cursor:"pointer";color:#777}a:hover{color:#aaa}</style><meta name="generator" content="Gatsby 2.13.51"/><link href="https://fonts.googleapis.com/css?family=Monstserrat:400,700&amp;display=swap" rel="stylesheet"/><style id="jss-server-side">.MuiPaper-root{color:#fff;transition:box-shadow .3s cubic-bezier(.4,0,.2,1) 0s;background-color:#424242}.MuiPaper-rounded{border-radius:4px}.MuiPaper-elevation0{box-shadow:none}.MuiPaper-elevation1{box-shadow:0 1px 3px 0 rgba(0,0,0,.2),0 1px 1px 0 rgba(0,0,0,.14),0 2px 1px -1px rgba(0,0,0,.12)}.MuiPaper-elevation2{box-shadow:0 1px 5px 0 rgba(0,0,0,.2),0 2px 2px 0 rgba(0,0,0,.14),0 3px 1px -2px rgba(0,0,0,.12)}.MuiPaper-elevation3{box-shadow:0 1px 8px 0 rgba(0,0,0,.2),0 3px 4px 0 rgba(0,0,0,.14),0 3px 3px -2px rgba(0,0,0,.12)}.MuiPaper-elevation4{box-shadow:0 2px 4px -1px rgba(0,0,0,.2),0 4px 5px 0 rgba(0,0,0,.14),0 1px 10px 0 rgba(0,0,0,.12)}.MuiPaper-elevation5{box-shadow:0 3px 5px -1px rgba(0,0,0,.2),0 5px 8px 0 rgba(0,0,0,.14),0 1px 14px 0 rgba(0,0,0,.12)}.MuiPaper-elevation6{box-shadow:0 3px 5px -1px rgba(0,0,0,.2),0 6px 10px 0 rgba(0,0,0,.14),0 1px 18px 0 rgba(0,0,0,.12)}.MuiPaper-elevation7{box-shadow:0 4px 5px -2px rgba(0,0,0,.2),0 7px 10px 1px rgba(0,0,0,.14),0 2px 16px 1px rgba(0,0,0,.12)}.MuiPaper-elevation8{box-shadow:0 5px 5px -3px rgba(0,0,0,.2),0 8px 10px 1px rgba(0,0,0,.14),0 3px 14px 2px rgba(0,0,0,.12)}.MuiPaper-elevation9{box-shadow:0 5px 6px -3px rgba(0,0,0,.2),0 9px 12px 1px rgba(0,0,0,.14),0 3px 16px 2px rgba(0,0,0,.12)}.MuiPaper-elevation10{box-shadow:0 6px 6px -3px rgba(0,0,0,.2),0 10px 14px 1px rgba(0,0,0,.14),0 4px 18px 3px rgba(0,0,0,.12)}.MuiPaper-elevation11{box-shadow:0 6px 7px -4px rgba(0,0,0,.2),0 11px 15px 1px rgba(0,0,0,.14),0 4px 20px 3px rgba(0,0,0,.12)}.MuiPaper-elevation12{box-shadow:0 7px 8px -4px rgba(0,0,0,.2),0 12px 17px 2px rgba(0,0,0,.14),0 5px 22px 4px rgba(0,0,0,.12)}.MuiPaper-elevation13{box-shadow:0 7px 8px -4px rgba(0,0,0,.2),0 13px 19px 2px rgba(0,0,0,.14),0 5px 24px 4px rgba(0,0,0,.12)}.MuiPaper-elevation14{box-shadow:0 7px 9px -4px rgba(0,0,0,.2),0 14px 21px 2px rgba(0,0,0,.14),0 5px 26px 4px rgba(0,0,0,.12)}.MuiPaper-elevation15{box-shadow:0 8px 9px -5px rgba(0,0,0,.2),0 15px 22px 2px rgba(0,0,0,.14),0 6px 28px 5px rgba(0,0,0,.12)}.MuiPaper-elevation16{box-shadow:0 8px 10px -5px rgba(0,0,0,.2),0 16px 24px 2px rgba(0,0,0,.14),0 6px 30px 5px rgba(0,0,0,.12)}.MuiPaper-elevation17{box-shadow:0 8px 11px -5px rgba(0,0,0,.2),0 17px 26px 2px rgba(0,0,0,.14),0 6px 32px 5px rgba(0,0,0,.12)}.MuiPaper-elevation18{box-shadow:0 9px 11px -5px rgba(0,0,0,.2),0 18px 28px 2px rgba(0,0,0,.14),0 7px 34px 6px rgba(0,0,0,.12)}.MuiPaper-elevation19{box-shadow:0 9px 12px -6px rgba(0,0,0,.2),0 19px 29px 2px rgba(0,0,0,.14),0 7px 36px 6px rgba(0,0,0,.12)}.MuiPaper-elevation20{box-shadow:0 10px 13px -6px rgba(0,0,0,.2),0 20px 31px 3px rgba(0,0,0,.14),0 8px 38px 7px rgba(0,0,0,.12)}.MuiPaper-elevation21{box-shadow:0 10px 13px -6px rgba(0,0,0,.2),0 21px 33px 3px rgba(0,0,0,.14),0 8px 40px 7px rgba(0,0,0,.12)}.MuiPaper-elevation22{box-shadow:0 10px 14px -6px rgba(0,0,0,.2),0 22px 35px 3px rgba(0,0,0,.14),0 8px 42px 7px rgba(0,0,0,.12)}.MuiPaper-elevation23{box-shadow:0 11px 14px -7px rgba(0,0,0,.2),0 23px 36px 3px rgba(0,0,0,.14),0 9px 44px 8px rgba(0,0,0,.12)}.MuiPaper-elevation24{box-shadow:0 11px 15px -7px rgba(0,0,0,.2),0 24px 38px 3px rgba(0,0,0,.14),0 9px 46px 8px rgba(0,0,0,.12)}.MuiAppBar-root{width:100%;display:flex;z-index:1100;box-sizing:border-box;flex-shrink:0;flex-direction:column}.MuiAppBar-positionFixed{top:0;left:auto;right:0;position:fixed}.MuiAppBar-positionAbsolute{top:0;left:auto;right:0;position:absolute}.MuiAppBar-positionSticky{top:0;left:auto;right:0;position:-webkit-sticky;position:sticky}.MuiAppBar-positionStatic{position:static}.MuiAppBar-positionRelative{position:relative}.MuiAppBar-colorDefault{color:#fff;background-color:#212121}.MuiAppBar-colorPrimary{color:#fff;background-color:#3f51b5}.MuiAppBar-colorSecondary{color:#fff;background-color:#f50057}.MuiToolbar-root{display:flex;position:relative;align-items:center}.MuiToolbar-gutters{padding-left:16px;padding-right:16px}@media (min-width:600px){.MuiToolbar-gutters{padding-left:24px;padding-right:24px}}.MuiToolbar-regular{min-height:56px}@media (min-width:0px) and (orientation:landscape){.MuiToolbar-regular{min-height:48px}}@media (min-width:600px){.MuiToolbar-regular{min-height:64px}}.MuiToolbar-dense{min-height:48px}.MuiTypography-root{margin:0}.MuiTypography-body2{font-size:.875rem;font-family:Roboto,Helvetica,Arial,sans-serif;font-weight:400;line-height:1.43;letter-spacing:.01071em}.MuiTypography-body1{font-size:1rem;font-family:Roboto,Helvetica,Arial,sans-serif;font-weight:400;line-height:1.5;letter-spacing:.00938em}.MuiTypography-caption{font-size:.75rem;font-family:Roboto,Helvetica,Arial,sans-serif;font-weight:400;line-height:1.66;letter-spacing:.03333em}.MuiTypography-button{font-size:.875rem;font-family:Roboto,Helvetica,Arial,sans-serif;font-weight:500;line-height:1.75;letter-spacing:.02857em;text-transform:uppercase}.MuiTypography-h1{font-size:6rem;font-family:Roboto,Helvetica,Arial,sans-serif;font-weight:300;line-height:1;letter-spacing:-.01562em}.MuiTypography-h2{font-size:3.75rem;font-family:Roboto,Helvetica,Arial,sans-serif;font-weight:300;line-height:1;letter-spacing:-.00833em}.MuiTypography-h3{font-size:3rem;font-family:Roboto,Helvetica,Arial,sans-serif;font-weight:400;line-height:1.04;letter-spacing:0}.MuiTypography-h4{font-size:2.125rem;font-family:Roboto,Helvetica,Arial,sans-serif;font-weight:400;line-height:1.17;letter-spacing:.00735em}.MuiTypography-h5{font-size:1.5rem;font-family:Roboto,Helvetica,Arial,sans-serif;font-weight:400;line-height:1.33;letter-spacing:0}.MuiTypography-h6{font-size:1.25rem;font-family:Roboto,Helvetica,Arial,sans-serif;font-weight:500;line-height:1.6;letter-spacing:.0075em}.MuiTypography-subtitle1{font-size:1rem;font-family:Roboto,Helvetica,Arial,sans-serif;font-weight:400;line-height:1.75;letter-spacing:.00938em}.MuiTypography-subtitle2{font-size:.875rem;font-family:Roboto,Helvetica,Arial,sans-serif;font-weight:500;line-height:1.57;letter-spacing:.00714em}.MuiTypography-overline{font-size:.75rem;font-family:Roboto,Helvetica,Arial,sans-serif;font-weight:400;line-height:2.66;letter-spacing:.08333em;text-transform:uppercase}.MuiTypography-srOnly{width:1px;height:1px;overflow:hidden;position:absolute}.MuiTypography-alignLeft{text-align:left}.MuiTypography-alignCenter{text-align:center}.MuiTypography-alignRight{text-align:right}.MuiTypography-alignJustify{text-align:justify}.MuiTypography-noWrap{overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.MuiTypography-gutterBottom{margin-bottom:.35em}.MuiTypography-paragraph{margin-bottom:16px}.MuiTypography-colorInherit{color:inherit}.MuiTypography-colorPrimary{color:#3f51b5}.MuiTypography-colorSecondary{color:#f50057}.MuiTypography-colorTextPrimary{color:#fff}.MuiTypography-colorTextSecondary{color:rgba(255,255,255,.7)}.MuiTypography-colorError{color:#f44336}.MuiTypography-displayInline{display:inline}.MuiTypography-displayBlock{display:block}.MuiButtonBase-root{color:inherit;border:0;cursor:pointer;margin:0;display:inline-flex;outline:0;padding:0;position:relative;align-items:center;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;border-radius:0;vertical-align:middle;-moz-appearance:none;justify-content:center;text-decoration:none;background-color:transparent;-webkit-appearance:none;-webkit-tap-highlight-color:transparent}.MuiButtonBase-root::-moz-focus-inner{border-style:none}.MuiButtonBase-root.Mui-disabled{cursor:default;pointer-events:none}.MuiButton-root{color:#fff;padding:6px 16px;font-size:.875rem;min-width:64px;box-sizing:border-box;transition:background-color 250ms cubic-bezier(.4,0,.2,1) 0s,box-shadow 250ms cubic-bezier(.4,0,.2,1) 0s,border 250ms cubic-bezier(.4,0,.2,1) 0s;font-family:Roboto,Helvetica,Arial,sans-serif;font-weight:500;line-height:1.75;border-radius:4px;letter-spacing:.02857em;text-transform:uppercase}.MuiButton-root:hover{text-decoration:none;background-color:rgba(255,255,255,.1)}.MuiButton-root.Mui-disabled{color:rgba(255,255,255,.3)}@media (hover:none){.MuiButton-root:hover{background-color:transparent}}.MuiButton-root:hover.Mui-disabled{background-color:transparent}.MuiButton-label{width:100%;display:inherit;align-items:inherit;justify-content:inherit}.MuiButton-text{padding:6px 8px}.MuiButton-textPrimary{color:#3f51b5}.MuiButton-textPrimary:hover{background-color:rgba(63,81,181,.1)}@media (hover:none){.MuiButton-textPrimary:hover{background-color:transparent}}.MuiButton-textSecondary{color:#f50057}.MuiButton-textSecondary:hover{background-color:rgba(245,0,87,.1)}@media (hover:none){.MuiButton-textSecondary:hover{background-color:transparent}}.MuiButton-outlined{border:1px solid rgba(255,255,255,.23);padding:5px 16px}.MuiButton-outlined.Mui-disabled{border:1px solid rgba(255,255,255,.3)}.MuiButton-outlinedPrimary{color:#3f51b5;border:1px solid rgba(63,81,181,.5)}.MuiButton-outlinedPrimary:hover{border:1px solid #3f51b5;background-color:rgba(63,81,181,.1)}@media (hover:none){.MuiButton-outlinedPrimary:hover{background-color:transparent}}.MuiButton-outlinedSecondary{color:#f50057;border:1px solid rgba(245,0,87,.5)}.MuiButton-outlinedSecondary:hover{border:1px solid #f50057;background-color:rgba(245,0,87,.1)}.MuiButton-outlinedSecondary.Mui-disabled{border:1px solid rgba(255,255,255,.3)}@media (hover:none){.MuiButton-outlinedSecondary:hover{background-color:transparent}}.MuiButton-contained{color:rgba(0,0,0,.87);box-shadow:0 1px 5px 0 rgba(0,0,0,.2),0 2px 2px 0 rgba(0,0,0,.14),0 3px 1px -2px rgba(0,0,0,.12);background-color:#e0e0e0}.MuiButton-contained.Mui-focusVisible{box-shadow:0 3px 5px -1px rgba(0,0,0,.2),0 6px 10px 0 rgba(0,0,0,.14),0 1px 18px 0 rgba(0,0,0,.12)}.MuiButton-contained:active{box-shadow:0 5px 5px -3px rgba(0,0,0,.2),0 8px 10px 1px rgba(0,0,0,.14),0 3px 14px 2px rgba(0,0,0,.12)}.MuiButton-contained.Mui-disabled{color:rgba(255,255,255,.3);box-shadow:none;background-color:rgba(255,255,255,.12)}.MuiButton-contained:hover{background-color:#d5d5d5}@media (hover:none){.MuiButton-contained:hover{background-color:#e0e0e0}}.MuiButton-contained:hover.Mui-disabled{background-color:rgba(255,255,255,.12)}.MuiButton-containedPrimary{color:#fff;background-color:#3f51b5}.MuiButton-containedPrimary:hover{background-color:#303f9f}@media (hover:none){.MuiButton-containedPrimary:hover{background-color:#3f51b5}}.MuiButton-containedSecondary{color:#fff;background-color:#f50057}.MuiButton-containedSecondary:hover{background-color:#c51162}@media (hover:none){.MuiButton-containedSecondary:hover{background-color:#f50057}}.MuiButton-colorInherit{color:inherit;border-color:currentColor}.MuiButton-sizeSmall{padding:4px 8px;font-size:.8125rem}.MuiButton-sizeLarge{padding:8px 24px;font-size:.9375rem}.MuiButton-fullWidth{width:100%}.jss34{color:#212121;flex-grow:1;padding-bottom:1rem;background-color:#80cbc4}.jss35{display:flex;flex-wrap:wrap;align-items:center;flex-direction:row;justify-content:space-between}.jss36{color:#212121;font-size:2rem;text-decoration:none}.jss36:hover{color:#eee}.jss37{font-size:2rem;border-radius:50%}.MuiContainer-root{width:100%;box-sizing:border-box;margin-left:auto;margin-right:auto;padding-left:16px;padding-right:16px}@media (min-width:600px){.MuiContainer-root{padding-left:24px;padding-right:24px}}@media (min-width:960px){.MuiContainer-root{padding-left:32px;padding-right:32px}}@media (min-width:600px){.MuiContainer-fixed{max-width:600px}}@media (min-width:960px){.MuiContainer-fixed{max-width:960px}}@media (min-width:1280px){.MuiContainer-fixed{max-width:1280px}}@media (min-width:1920px){.MuiContainer-fixed{max-width:1920px}}@media (min-width:0px){.MuiContainer-maxWidthXs{max-width:444px}}@media (min-width:600px){.MuiContainer-maxWidthSm{max-width:600px}}@media (min-width:960px){.MuiContainer-maxWidthMd{max-width:960px}}@media (min-width:1280px){.MuiContainer-maxWidthLg{max-width:1280px}}@media (min-width:1920px){.MuiContainer-maxWidthXl{max-width:1920px}}.jss4{width:100%;height:200px;display:block;overflow:hidden;margin-top:3rem;background-color:#00897b}.jss5{width:100%;height:100%;margin:O;border-radius:0;background-color:#b2dfdb}.jss6{width:100%;height:68px;display:flex;padding:1rem;overflow:hidden;transform:skew(0deg,-2deg) translateY(55px);justify-content:center;background-color:#80cbc4}.jss1{padding:18px 36px;margin-top:80px;background-color:#424242}.jss2 p{text-indent:24px}</style><title data-react-helmet="true">Theming a gatsby site leveraging the gatsby-browser API | 🦔 ~ Erizo&#x27;s Blog</title><meta data-react-helmet="true" name="description" content=" Does Gatsby&#x27;s state management makes providing a theme context trickier than it should "/><meta data-react-helmet="true" property="og:title" content="Theming a gatsby site leveraging the gatsby-browser API"/><meta data-react-helmet="true" property="og:description" content=" Does Gatsby&#x27;s state management makes providing a theme context trickier than it should "/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:creator" content="Erizo-dev"/><meta data-react-helmet="true" name="twitter:title" content="Theming a gatsby site leveraging the gatsby-browser API"/><meta data-react-helmet="true" name="twitter:description" content=" Does Gatsby&#x27;s state management makes providing a theme context trickier than it should "/><style type="text/css">.gatsby-resp-image-image{width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;color:transparent;}</style><link rel="shortcut icon" href="/erizo-dev-blog/icons/icon-48x48.png?v=596c4a792cca3dbf5ecb45442a280785"/><link rel="manifest" href="/erizo-dev-blog/manifest.webmanifest"/><meta name="theme-color" content="#663399"/><link rel="apple-touch-icon" sizes="48x48" href="/erizo-dev-blog/icons/icon-48x48.png?v=596c4a792cca3dbf5ecb45442a280785"/><link rel="apple-touch-icon" sizes="72x72" href="/erizo-dev-blog/icons/icon-72x72.png?v=596c4a792cca3dbf5ecb45442a280785"/><link rel="apple-touch-icon" sizes="96x96" href="/erizo-dev-blog/icons/icon-96x96.png?v=596c4a792cca3dbf5ecb45442a280785"/><link rel="apple-touch-icon" sizes="144x144" href="/erizo-dev-blog/icons/icon-144x144.png?v=596c4a792cca3dbf5ecb45442a280785"/><link rel="apple-touch-icon" sizes="192x192" href="/erizo-dev-blog/icons/icon-192x192.png?v=596c4a792cca3dbf5ecb45442a280785"/><link rel="apple-touch-icon" sizes="256x256" href="/erizo-dev-blog/icons/icon-256x256.png?v=596c4a792cca3dbf5ecb45442a280785"/><link rel="apple-touch-icon" sizes="384x384" href="/erizo-dev-blog/icons/icon-384x384.png?v=596c4a792cca3dbf5ecb45442a280785"/><link rel="apple-touch-icon" sizes="512x512" href="/erizo-dev-blog/icons/icon-512x512.png?v=596c4a792cca3dbf5ecb45442a280785"/><link as="script" rel="preload" href="/erizo-dev-blog/component---src-templates-blog-post-js-633b9701e741c6aed84c.js"/><link as="script" rel="preload" href="/erizo-dev-blog/1-33801cd08808b344e8dc.js"/><link as="script" rel="preload" href="/erizo-dev-blog/app-5b4eed37dfab0c59df4a.js"/><link as="script" rel="preload" href="/erizo-dev-blog/styles-1601fc2f2fad7609d2c8.js"/><link as="script" rel="preload" href="/erizo-dev-blog/webpack-runtime-fa218fc683a671e9396d.js"/><link as="fetch" rel="preload" href="/erizo-dev-blog/page-data\gatsby-state-theme\page-data.json" crossorigin="use-credentials"/></head><body><noscript id="gatsby-noscript">This app works best with JavaScript enabled.</noscript><div id="___gatsby"><div style="outline:none" tabindex="-1" role="group" id="gatsby-focus-wrapper"><div class="MuiPaper-root MuiPaper-elevation1 jss5 MuiPaper-rounded"><header class="MuiPaper-root MuiPaper-elevation4 MuiAppBar-root MuiAppBar-positionFixed jss34 MuiAppBar-colorPrimary mui-fixed"><div class="MuiToolbar-root MuiToolbar-regular jss35 MuiToolbar-gutters"><h2 class="MuiTypography-root MuiTypography-h2"><a class="jss36" href="/erizo-dev-blog/">🦔 ~ Erizo&#x27;s Blog</a></h2><button class="MuiButtonBase-root MuiButton-root jss37 MuiButton-text" tabindex="0" type="button"><span class="MuiButton-label">🔦</span></button></div></header><div class="MuiContainer-root jss3 MuiContainer-maxWidthSm"><div class="MuiContainer-root jss1 MuiContainer-maxWidthLg"><h1>Theming a gatsby site leveraging the gatsby-browser API</h1><p>2019-08-29</p><p>Appetite required : <!-- -->🍰🍰🍰<!-- --> -<!-- --> <!-- -->3<!-- --> minutes</p><div class="jss2"><p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;"
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 66.67226890756302%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAMBBf/EABUBAQEAAAAAAAAAAAAAAAAAAAAB/9oADAMBAAIQAxAAAAHuo6VSR//EABYQAQEBAAAAAAAAAAAAAAAAAAAhEP/aAAgBAQABBQLaqv/EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABgQAAIDAAAAAAAAAAAAAAAAABAxAAFR/9oACAEBAAY/Ai72Mf/EAB0QAAEDBQEAAAAAAAAAAAAAAAABETEQIVGB4fH/2gAIAQEAAT8hq214FhfL8EXI/9oADAMBAAIAAwAAABBj7//EABURAQEAAAAAAAAAAAAAAAAAABAh/9oACAEDAQE/EIf/xAAWEQEBAQAAAAAAAAAAAAAAAAAAIVH/2gAIAQIBAT8Qq4//xAAdEAEAAQQDAQAAAAAAAAAAAAABEQAhMUEQUYHB/9oACAEBAAE/EDmGNU2LnjFJth0hj4pUu7IQWr//2Q=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="Photo by Lucas Fonseca"
        title="Photo by Lucas Fonseca"
        src="/erizo-dev-blog/static/dbfea9cf02ea11aa28df8f61eeb57c0e/c739e/flowers.jpg"
        srcset="/erizo-dev-blog/static/dbfea9cf02ea11aa28df8f61eeb57c0e/8ee9c/flowers.jpg 148w,
/erizo-dev-blog/static/dbfea9cf02ea11aa28df8f61eeb57c0e/ebbe7/flowers.jpg 295w,
/erizo-dev-blog/static/dbfea9cf02ea11aa28df8f61eeb57c0e/c739e/flowers.jpg 590w,
/erizo-dev-blog/static/dbfea9cf02ea11aa28df8f61eeb57c0e/5413e/flowers.jpg 885w,
/erizo-dev-blog/static/dbfea9cf02ea11aa28df8f61eeb57c0e/4efde/flowers.jpg 1180w,
/erizo-dev-blog/static/dbfea9cf02ea11aa28df8f61eeb57c0e/b4726/flowers.jpg 5950w"
        sizes="(max-width: 590px) 100vw, 590px"
      />
    </span></p>
<h2>Gatsby is not preserving the state I have provided in the layout when I change page</h2>
<p> When writing this blog, I wanted to experiment with <a href="https://material-ui.com/">@material-ui</a>. I took a look at theming and found pretty sweet the ability to switch to a dark theme by only toggling a single property.
Reading Material-ui documentation I first thought I could provide my theme state context in my Layout component.</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">Layout</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> children <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
 
 <span class="token keyword">const</span> <span class="token punctuation">[</span>theme<span class="token punctuation">,</span> setTheme<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span>
 <span class="token keyword">const</span> <span class="token function-variable function">toggleDarkMode</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
   <span class="token function">setTheme</span><span class="token punctuation">(</span><span class="token operator">!</span>theme<span class="token punctuation">)</span>
 <span class="token punctuation">}</span>

   <span class="token keyword">const</span> lightTheme <span class="token operator">=</span> <span class="token function">createMuiTheme</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
   palette <span class="token punctuation">:</span> <span class="token punctuation">{</span>
     type<span class="token punctuation">:</span> <span class="token string">'light'</span>
   <span class="token punctuation">}</span>
   <span class="token punctuation">}</span><span class="token punctuation">)</span>
   <span class="token keyword">const</span> darkTheme <span class="token operator">=</span> <span class="token function">createMuiTheme</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
     palette <span class="token punctuation">:</span> <span class="token punctuation">{</span>
       type<span class="token punctuation">:</span> <span class="token string">'dark'</span>
     <span class="token punctuation">}</span>
     <span class="token punctuation">}</span><span class="token punctuation">)</span>

 <span class="token keyword">return</span> <span class="token punctuation">(</span>
   <span class="token operator">&lt;</span>ThemeProvider theme<span class="token operator">=</span><span class="token punctuation">{</span>theme <span class="token operator">?</span> lightTheme<span class="token punctuation">:</span> darkTheme<span class="token punctuation">}</span><span class="token operator">></span>
   <span class="token comment">// ...</span>
       <span class="token operator">&lt;</span>Header
         toggleDarkMode<span class="token operator">=</span><span class="token punctuation">{</span>toggleDarkMode<span class="token punctuation">}</span>
       <span class="token operator">/</span><span class="token operator">></span>
   <span class="token comment">// ...</span></code></pre></div>
<p>I soon figured out that this approach does not work so well, and that the state is lost during each navigation between pages.
This behavior kind of surprised me in the first place. I quickly googled my issue and found <a href="https://featurist.co.uk/blog/react-hooks/">this post</a>. </p>
<p>Storing the state in the local storage so that it survives navigation does come with some extra benefits: our state will survive a full page refresh and it is simple to implement as you only need to swap your useState hook with <a href="https://usehooks.com/useLocalStorage">useLocalStorage</a>. You don’t even have to write it yourself which is pretty sweet.</p>
<h2>But if I do want to use state and not local storage</h2>
<p>The above solution does not provide any answer on how we could persist our state though, but searching the Gatsby documentation does! Gatsby provides a dedicated method in its <a href="https://www.gatsbyjs.org/docs/browser-apis/#wrapRootElement">browser-Api</a>.</p>
<p>This wrap root element method let you set up any provider and makes it available everywhere in your application.
There even is a detailed use-case provided <a href="https://www.gatsbyjs.org/blog/2019-01-31-using-react-context-api-with-gatsby/">here</a>.</p>
<p>If you are interested in how to set this us with our <a href="https://material-ui.com/">@material-ui</a> themeProvider, here is how it could look like.</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token comment">// gatsby-browser.js</span>
<span class="token keyword">const</span> MyProvider <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"./src/Context/myContext"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>myProvider

exports<span class="token punctuation">.</span><span class="token function-variable function">wrapPageElement</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> element<span class="token punctuation">,</span> props <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
   <span class="token operator">&lt;</span>MyProvider <span class="token punctuation">{</span><span class="token operator">...</span>props<span class="token punctuation">}</span><span class="token operator">></span><span class="token punctuation">{</span>element<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>MyProvider<span class="token operator">></span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre></div>
<p>With a context which could look like this (Please not that I reused the useLocalstorage hook, but this was only to handle the full browser refresh).</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token comment">// /src/Context/myContext.js</span>
<span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">"react"</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> ThemeProvider <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"@material-ui/styles"</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> createMuiTheme <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"@material-ui/core/styles"</span>
<span class="token keyword">import</span> useLocalStorage <span class="token keyword">from</span> <span class="token string">"../hooks/UseLocalStorage"</span>

<span class="token keyword">const</span> lightTheme <span class="token operator">=</span> <span class="token function">createMuiTheme</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  palette<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    type<span class="token punctuation">:</span> <span class="token string">"light"</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> darkTheme <span class="token operator">=</span> <span class="token function">createMuiTheme</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  palette<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    type<span class="token punctuation">:</span> <span class="token string">"dark"</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> defaultState <span class="token operator">=</span> <span class="token punctuation">{</span>
  theme<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token function-variable function">toggleDarkMode</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> myContext <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">createContext</span><span class="token punctuation">(</span>defaultState<span class="token punctuation">)</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">myProvider</span> <span class="token operator">=</span> <span class="token parameter">props</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>theme<span class="token punctuation">,</span> setTheme<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useLocalStorage</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> <span class="token function-variable function">toggleDarkMode</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token function">setTheme</span><span class="token punctuation">(</span><span class="token operator">!</span>theme<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>ThemeProvider theme<span class="token operator">=</span><span class="token punctuation">{</span>theme <span class="token operator">?</span> lightTheme <span class="token punctuation">:</span> darkTheme<span class="token punctuation">}</span><span class="token operator">></span>
      <span class="token operator">&lt;</span>myContext<span class="token punctuation">.</span>Provider value<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>
          theme<span class="token punctuation">,</span>
          toggleDarkMode
      <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">></span>
      <span class="token punctuation">{</span>props<span class="token punctuation">.</span>children<span class="token punctuation">}</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>myContext<span class="token punctuation">.</span>Provider<span class="token operator">></span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>ThemeProvider<span class="token operator">></span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre></div>
<p>You can consume this context anywhere, using the appropriate hook for instance.</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> ctx <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">useContext</span><span class="token punctuation">(</span>myContext<span class="token punctuation">)</span></code></pre></div>
<h2>And your site’s CSS does weird things when you run your production build</h2>
<p>This indeed is a last-minute update 😥</p>
<p>I ran into two different issues when building this blog for production for the first time :
-The first is that for some reason my theme object was not available when building the final HTML. I think it had to do with inconsistencies between my gatsby-browser and my gatsby-ssr.js files. I will dig deeper into that issue, but my quick and dirty fix was to have those two files the same.
-The second issue seems to be related @material-ui prefixes its classes names. I found this issue mentioned in this GitHub <a href="https://github.com/gatsbyjs/gatsby/issues/9121">issue</a>. Once again I ended choosing the easy way, and as avised in the issue thread I have added the <a href="https://www.gatsbyjs.org/packages/gatsby-plugin-material-ui/">gatsby-plugin-material-ui</a> plugin.</p>
<p>I hope this post can be helpful to anyone trying to make @material-ui and gatsby work nicely together.</p></div><hr/><ul style="display:flex;flex-wrap:wrap;justify-content:space-between;list-style:none;padding:0"><li><a rel="prev" href="/erizo-dev-blog/electron-powershell-next/">← <!-- -->Beautiful admin tools with Powershell and Electron</a></li><li></li></ul></div></div><footer class="jss4"><div class="jss6">© <!-- -->2019<!-- -->, Built with <a href="https://www.gatsbyjs.org">Gatsby</a></div></footer></div></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/gatsby-state-theme/";window.webpackCompilationHash="886c7d557c8797974b98";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-5b4eed37dfab0c59df4a.js"],"component---src-templates-blog-post-js":["/component---src-templates-blog-post-js-633b9701e741c6aed84c.js"],"component---src-pages-404-js":["/component---src-pages-404-js-2646cc38ef318dfab22a.js"],"component---src-pages-index-js":["/component---src-pages-index-js-77d07ab9da2e5cf0b965.js"]};/*]]>*/</script><script src="/erizo-dev-blog/webpack-runtime-fa218fc683a671e9396d.js" async=""></script><script src="/erizo-dev-blog/styles-1601fc2f2fad7609d2c8.js" async=""></script><script src="/erizo-dev-blog/app-5b4eed37dfab0c59df4a.js" async=""></script><script src="/erizo-dev-blog/1-33801cd08808b344e8dc.js" async=""></script><script src="/erizo-dev-blog/component---src-templates-blog-post-js-633b9701e741c6aed84c.js" async=""></script></body></html>